<!DOCTYPE html>
<html lang="id">
<head>
  <title>Karang Taruna - Portal</title>
  
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<meta name="theme-color" content="#0e0e10"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/css/style.css">
<link rel="stylesheet" href="assets/css/glass.css">
<link rel="stylesheet" href="assets/css/header.css">

</head>
<body>
  <header id="mainHeader" class="glass expanded">
    <div class="header-content">
      <div style="display:flex;align-items:center;gap:10px">
        <img src="assets/img/logo.png" class="logo" alt="Logo"/>
        <div class="title">
          <h1>Portal Karang Taruna</h1>
          <p>Pemuda Bersatu • Aksi Nyata</p>
        </div>
      </div>
      <div class="header-actions">
        <a class="btn-glass" href="login.html">Masuk</a>
        <a class="btn-glass" href="register.html">Daftar</a>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <section class="hero">
        <div class="glass card">
          <h1>Selamat datang di Portal Karang Taruna</h1>
          <p>Kelola kegiatan, UMKM, berita, kas, dokumen, esport, dan komunitas — dalam satu ekosistem digital.</p>
        </div>
      </section>

      <section>
        <div class="section-title"><h2>Berita Terbaru</h2><a class="btn" href="berita.html">Lihat Semua</a></div>
        <div class="grid" id="newsGrid"></div>
      </section>

      <section>
        <div class="section-title"><h2>Kegiatan</h2><a class="btn" href="kegiatan.html">Lihat Semua</a></div>
        <div class="grid" id="eventGrid"></div>
      </section>

      <section>
        <div class="section-title"><h2>UMKM Anggota</h2><a class="btn" href="umkm.html">Lihat Semua</a></div>
        <div class="grid" id="umkmGrid"></div>
      </section>

      <footer class="container"><p>&copy; 2025 Karang Taruna • Dibuat dengan ❤ Liquid Glass UI</p></footer>
    </div>
  </main>

  <script src="scripts/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="scripts/ui.js"></script>
  <script>
    const db = firebase.firestore();
    async function loadPublic(){
      const news = await db.collection('berita').orderBy('createdAt','desc').limit(6).get();
      const grid = document.getElementById('newsGrid');
      grid.innerHTML = news.docs.map(d=>{
        const x=d.data();
        return `<div class='glass card'><span class='badge'>${(x.tanggal||'').toString().slice(0,10)}</span><h3>${x.judul||'-'}</h3><p>${(x.isi||'').slice(0,120)}...</p></div>`
      }).join('') || "<div class='glass card'>Belum ada berita.</div>";

      const ev = await db.collection('kegiatan').orderBy('createdAt','desc').limit(6).get();
      const egrid = document.getElementById('eventGrid');
      egrid.innerHTML = ev.docs.map(d=>{
        const x=d.data();
        return `<div class='glass card'><span class='badge'>${(x.tanggal||'').toString().slice(0,10)}</span><h3>${x.judul||'-'}</h3><p>${(x.deskripsi||'').slice(0,120)}...</p></div>`
      }).join('') || "<div class='glass card'>Belum ada kegiatan.</div>";

      const um = await db.collection('umkm').orderBy('createdAt','desc').limit(6).get();
      const ugrid = document.getElementById('umkmGrid');
      ugrid.innerHTML = um.docs.map(d=>{
        const x=d.data();
        return `<div class='glass card'><h3>${x.nama_usaha||'-'}</h3><p>${(x.deskripsi||'').slice(0,120)}...</p><a class='btn' target='_blank' href='https://wa.me/${(x.waLink||'').replace(/\D/g,"")}?text=Halo%20saya%20tertarik'>WhatsApp</a></div>`
      }).join('') || "<div class='glass card'>Belum ada UMKM.</div>";
    }
    loadPublic();
  </script>
</body>
</html>
